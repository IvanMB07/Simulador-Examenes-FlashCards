<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Simulador de Examen</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="contenedor">
        <div class="encabezado">
            <h1>Simulador de API</h1>
            <div class="timer">
                <span class="contador">Pregunta: <strong id="numeroPregunta">1</strong>/<strong id="totalPreguntasActual">25</strong></span>
                <span class="contador" id="tiempoTranscurrido">Tiempo: 0s</span>
                <span class="modo-pill">Modo: <strong id="modoActual">-</strong></span>
            </div>
            <div style="text-align: right; font-size: 11px; color: #666; margin-top: 8px; font-family: monospace;" id="totalPreguntasInfo"></div>
            <div class="progreso">
                <div class="progreso-barra" id="progresoBarra"></div>
            </div>
        </div>

        <div id="seleccionModo">
            <div class="resultados">
                <div class="titulo-resultados">Elige modo</div>
                <div class="mensaje-resultado">
                    <strong>Pr√°ctica</strong>: 25 preguntas de los temas seleccionados, feedback instant√°neo y puedes volver atr√°s.<br>
                    <strong>Examen</strong>: 30 preguntas, 75 minutos, estilo oficial y nota por f√≥rmula.<br>
                    <strong>Test de Fallos</strong>: Repasa √∫nicamente las preguntas que has fallado anteriormente.
                </div>

                <div class="config-section">
                    <div class="config-title">üßæ Parcial de Examen</div>
                    <div class="config-description" style="margin-bottom: 10px; color: #888;">
                        Selecci√≥n usada solo en Modo Examen
                    </div>
                    <select id="parcialExamenSelect" class="perfil-select" onchange="cambiarParcialExamen()" style="width:100%;">
                        <option value="parcial1">Parcial 1 (T1, T2, T3, T4)</option>
                        <option value="parcial2">Parcial 2 (T5, T6)</option>
                        <option value="parcial3">Parcial 3 (T7)</option>
                    </select>
                </div>
                
                <!-- Selector de perfil de usuario -->
                <div class="perfil-selector">
                    <div class="perfil-selector-title">üë§ Perfil de Usuario</div>
                    <div class="perfil-selector-content">
                        <select id="perfilSelect" class="perfil-select" onchange="cambiarPerfil()">
                            <option value="default">Usuario Principal</option>
                        </select>
                        <button class="btn-perfil" onclick="crearNuevoPerfil()">+ Nuevo</button>
                        <button class="btn-perfil danger" onclick="eliminarPerfilActual()" id="btnEliminar">Eliminar</button>
                    </div>
                    <div class="perfil-stats" id="perfilStats">
                        Cargando estad√≠sticas...
                    </div>
                </div>

                <div class="config-section">
                    <div class="config-title">üìö Seleccionar Temas (solo Modo Pr√°ctica)</div>
                    <div class="config-description" style="margin-bottom: 10px; color: #888;">
                        25 preguntas distribuidas proporcionalmente entre los temas seleccionados
                    </div>
                    <div id="infoDistribucion" style="margin-bottom: 15px; padding: 10px; background: #1a1a1a; border-radius: 6px; font-size: 13px; color: #00d4ff;"></div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 10px; max-width: 100%; overflow: hidden;">
                        <label class="tema-checkbox">
                            <input type="checkbox" value="1" checked onchange="toggleTema(1)">
                            <span>Tema 1</span>
                        </label>
                        <label class="tema-checkbox">
                            <input type="checkbox" value="2" checked onchange="toggleTema(2)">
                            <span>Tema 2</span>
                        </label>
                        <label class="tema-checkbox">
                            <input type="checkbox" value="3" checked onchange="toggleTema(3)">
                            <span>Tema 3</span>
                        </label>
                        <label class="tema-checkbox">
                            <input type="checkbox" value="4" checked onchange="toggleTema(4)">
                            <span>Tema 4</span>
                        </label>
                        <label class="tema-checkbox">
                            <input type="checkbox" value="5" checked onchange="toggleTema(5)">
                            <span>Tema 5</span>
                        </label>
                        <label class="tema-checkbox">
                            <input type="checkbox" value="6" checked onchange="toggleTema(6)">
                            <span>Tema 6</span>
                        </label>
                    </div>
                    <div class="config-option" style="margin-top: 15px;">
                        <div>
                            <div class="config-label">Ordenar por temas</div>
                            <div class="config-description">Las preguntas se agrupan por tema secuencialmente</div>
                        </div>
                        <div class="toggle-switch" id="toggleOrdenTema" onclick="toggleConfig('ordenarPorTema')">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>

                <div class="config-section">
                    <div class="stat" id="statFallos">
                        <div class="stat-label">Preguntas falladas guardadas</div>
                        <div class="stat-valor" id="contadorFallos">0</div>
                    </div>
                  <div class="config-option" style="margin-top: 10px;">
                    <div style="flex: 1;">
                      <div class="config-label">Importar / Exportar fallos</div>
                      <div class="config-description">Sincroniza fallos entre m√≥vil y PC en JSON</div>
                      <div style="margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
                        <input id="importFallosFile" type="file" accept="application/json" style="color:#e0e0e0;" onchange="importarFallosDesdeArchivo(event)">
                        <button class="btn-anterior" onclick="exportarFallos()">Exportar JSON</button>
                      </div>
                    </div>
                  </div>
                    <button class="btn-anterior" id="btnLimpiarFallos" onclick="limpiarFallos()" style="width: 100%; margin-top: 10px;">
                        üóëÔ∏è Limpiar preguntas falladas
                    </button>
                </div>
                
                <div class="botones">
                    <button class="btn-reiniciar" onclick="iniciarModo('practica')">Modo pr√°ctica</button>
                    <button class="btn-terminar" onclick="iniciarModo('examen')">Modo examen</button>
                    <button class="btn-test-fallos" id="btnTestFallos" onclick="iniciarModo('fallos')" disabled>Test de Fallos <span class="badge-fallos" id="badgeFallos">0</span></button>
                </div>
            </div>
        </div>

        <div id="examen" class="oculto">
            <div class="pregunta-contenedor">
                <div class="pregunta-numero" id="preguntaNumero"></div>
                <div class="pregunta-texto" id="preguntaTexto"></div>
                <div class="opciones" id="opcionesContenedor"></div>
            </div>

            <div class="atajos-teclado">
                ‚å®Ô∏è <strong>Atajos:</strong> 
                <span class="tecla">‚Üê</span> <span class="tecla">‚Üí</span> Navegar preguntas | 
                <span class="tecla">‚Üë</span> <span class="tecla">‚Üì</span> Navegar opciones | 
                <span class="tecla">Espacio</span> o <span class="tecla">1-4</span> Seleccionar | 
                <span class="tecla">Enter</span> Terminar
            </div>

            <div class="botones">
                <button class="btn-anterior" id="btnAnterior" onclick="app.anterior()">‚Üê Anterior</button>
                <button class="btn-siguiente" id="btnSiguiente" onclick="app.siguiente()">Siguiente ‚Üí</button>
                <button class="btn-terminar" onclick="app.terminar()">Terminar Examen</button>
            </div>
        </div>

        <div id="resultados" class="oculto">
            <div class="resultados">
                <div class="titulo-resultados">Examen Completado</div>
                <div class="mensaje-resultado">Tu puntuaci√≥n final es:</div>
                <div class="puntuacion" id="puntuacionFinal">0/10</div>
                
                <div class="estadisticas">
                    <div class="stat">
                        <div class="stat-label">Correctas</div>
                        <div class="stat-valor" id="respuestasCorrectas">0</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">Incorrectas</div>
                        <div class="stat-valor" id="respuestasIncorrectas">0</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">Sin responder</div>
                        <div class="stat-valor" id="sinResponder">0</div>
                    </div>
                </div>

                <div id="erroresDetalle" class="errores-detalle oculto"></div>

                <button class="btn-reiniciar" onclick="app.reiniciar()">Reiniciar Examen</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
